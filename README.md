# U-Word 写作统计仪表盘

一个现代化的个人写作进度追踪和数据分析仪表盘，帮助你可视化写作习惯和生产力指标。

## 功能特性

### 核心统计展示
- **总字数统计**：实时显示当前文档的总字数
- **每日变化**：显示当日净增/减少的字数（正数绿色，负数红色）
- **写作连续天数**：自动计算连续写作天数，激励保持写作习惯

### 数据可视化
- **GitHub 风格热力图**：以日历热力图形式展示写作强度，颜色深浅代表当日投入度
- **复合趋势图表**：
  - 柱状图：每日新增字数
  - 折线图：累计字数增长趋势
  - 双 Y 轴展示，数据一目了然

### 交互功能
- **CSV 文件上传**：支持自定义数据导入
- **时间范围筛选**：支持 7 天 / 30 天 / 180 天数据视图切换
- **主题切换**：支持亮色/暗色主题自动切换
- **缓存管理**：使用 localStorage 持久化数据，避免重复导入
- **最近保存记录**：显示最近 3 次文件保存详情（文件名、时间戳、字数）

### 响应式设计
- 移动端友好的自适应布局
- 跨设备一致的使用体验

## 使用指南

### 上传 CSV 数据

1. 准备好符合格式要求的 CSV 文件（格式说明见下文）
2. 点击页面上的「上传 CSV」按钮
3. 选择你的 CSV 文件
4. 数据会自动解析并更新仪表盘

### 数据缓存

- 上传的 CSV 数据会自动保存到浏览器缓存
- 下次打开页面会优先使用缓存数据，无需重新上传
- 点击「清除缓存」可以清除已保存的数据

### 视图控制

**时间范围筛选**
- 使用时间范围选择器切换：7 天 / 30 天 / 180 天
- 图表和统计数据会根据选择的时间范围动态更新

**主题切换**
- 点击右上角主题图标切换亮色/暗色模式
- 系统会自动检测并跟随系统主题偏好

## 数据格式说明

### CSV 文件格式

仪表盘使用 CSV 文件存储写作记录，格式如下：

```csv
timestamp,filename,total_words,word_change
2025-09-01 09:30:00,硕士论文初稿.docx,120,+120
2025-09-05 14:20:00,硕士论文初稿.docx,350,+230
```

### 字段说明

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `timestamp` | string | 保存时间戳（YYYY-MM-DD HH:MM:SS） | `2025-09-01 09:30:00` |
| `filename` | string | 文件名 | `硕士论文初稿.docx` |
| `total_words` | number | 当前文档总字数 | `120` |
| `word_change` | number | 字数变化量（可正可负） | `+120` 或 `-50` |

## 数据计算方式

### 1. 每日聚合（Daily Aggregation）

将同一天的所有记录聚合为一条数据，包含以下指标：

**核心指标**：
- **total_words**：当天最后保存时的总字数
- **net_change**：净变化量 = 当天最后总字数 - 前一天最后总字数
- **total_investment**：总投入量 = 当天所有 |word_change| 的总和（绝对值累加）

**计算步骤**：

1. **按日期分组**：将所有记录按 `timestamp` 的日期部分分组
2. **计算 total_words**：取当天最后一条记录的 `total_words`
3. **计算 total_investment**：累加当天所有记录的 `|word_change|` 绝对值
4. **计算 net_change**：
   - 第一天：`total_investment`
   - 其他天：`当天 total_words - 前一天 total_words`

### 2. 写作连续天数（Writing Streak）

**算法逻辑**：

```
从最近有数据的日期开始，向前遍历每一天：
- 如果当天有数据且 net_change != 0，连续天数 +1
- 如果当天无数据或 net_change = 0，停止计数
```

**特点**：
- 按日历日期连续计算（不是按记录间隔）
- 只要当天净变化不为 0 就计入连续天数
- 激励每天保持写作，即使只写一个字

**示例**：
```
假设数据：
- 2026-01-13: net_change = 2000 ✓
- 2026-01-12: net_change = 1700 ✓
- 2026-01-11: net_change = 1600 ✓
- 2026-01-10: net_change = 0    ✗

写作连续天数 = 3 天
```

### 3. 热力图数据（Heatmap）

使用 `total_investment` 作为每日的活跃度指标，颜色映射规则：

- **无数据**：灰色
- **低投入**（1-500 字）：浅绿色
- **中投入**（501-1500 字）：中绿色
- **高投入**（1501+ 字）：深绿色

### 4. 趋势图表（Trend Chart）

**柱状图**：显示每日 `net_change`（净变化）
- 正值：绿色（表示新增）
- 负值：红色（表示删除）

**折线图**：显示累计 `total_words`（总字数）
- 展示整体增长趋势
- 左 Y 轴：每日字数变化
- 右 Y 轴：累计总字数

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

支持所有现代浏览器，需要启用 JavaScript 和 localStorage。

## 常见问题

### Q: CSV 文件有格式要求吗？
A: 是的，必须包含表头和四列数据（timestamp, filename, total_words, word_change），详见 [数据格式说明](#csv-文件格式)。

### Q: 如何处理删除字数的情况？
A: `word_change` 使用负数表示删除，系统会正确计算 `net_change`。注意连续天数只统计 `net_change != 0` 的日期。

### Q: 数据会上传到服务器吗？
A: 不会。所有数据处理都在浏览器端完成，不会上传到任何服务器。

### Q: 如何追踪多个文档？
A: 目前版本追踪单个文档。未来版本可添加文档筛选功能。

### Q: 清除缓存后数据会丢失吗？
A: 清除缓存会删除 localStorage 中的数据，但不会影响你的 CSV 源文件，重新上传即可。

## 许可证

MIT License

---

**开始追踪你的写作旅程吧！** ✍️📊
